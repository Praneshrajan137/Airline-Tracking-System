# ============================================
# AIRLINE TRACKER SYSTEM - ENVIRONMENT VARIABLES
# ============================================
# IMPORTANT: Copy this file to .env and fill in your actual values
# Source: Phase 4 Health Audit + Phase 5 Production Deployment
#
# Usage:
#   1. cp env.example .env
#   2. Edit .env with your actual API keys and passwords
#   3. Never commit .env to version control (it's in .gitignore)
#   4. For production, use secure secret management tools

# ============================================
# EXTERNAL API KEYS (REQUIRED FOR PRODUCTION)
# ============================================

# FlightAware AeroAPI Key
# Sign up and get your API key from: https://www.flightaware.com/commercial/aeroapi/
# Pricing: Free tier available (10,000 queries/month = ~333/day)
# Required for: Flight data retrieval (flightdata-service)
# FREE TIER: 500 requests/month | STRICT LIMIT: 390 requests/month (78%, 22% buffer)
# MONTHLY COST: $0 (stays within free tier)
FLIGHTAWARE_API_KEY=your_flightaware_api_key_here
FLIGHTAWARE_BASE_URL=https://aeroapi.flightaware.com/aeroapi
FLIGHTAWARE_RATE_LIMIT_ENABLED=true
FLIGHTAWARE_RATE_LIMIT_CALLS_PER_MINUTE=1    # Well below 5/min API limit
FLIGHTAWARE_RATE_LIMIT_CALLS_PER_HOUR=10     # Conservative hourly cap
FLIGHTAWARE_RATE_LIMIT_CALLS_PER_DAY=13      # 13/day × 30 = 390/month

# OpenAI API Key
# Get your API key from: https://platform.openai.com/api-keys
# RECOMMENDED: gpt-4o-mini ($0.45/month) | gpt-3.5-turbo ($2.40/month)
# $5 BUDGET: 3,000 summaries/month (100/day) | MONTHLY COST: $2.40 (48% of budget)
# Required for: Flight summary generation (llm-summary-service)
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o-mini
OPENAI_MAX_TOKENS=150
OPENAI_TEMPERATURE=0.7
OPENAI_RATE_LIMIT_ENABLED=true
OPENAI_RATE_LIMIT_CALLS_PER_MINUTE=3         # Prevent burst usage
OPENAI_RATE_LIMIT_CALLS_PER_HOUR=10          # Conservative hourly cap
OPENAI_RATE_LIMIT_CALLS_PER_DAY=100          # 100/day × 30 = 3,000/month ($2.40)

# ============================================
# DATABASE CONFIGURATION (REQUIRED FOR PRODUCTION)
# ============================================

# PostgreSQL Database (used by llm-summary-service)
# SECURITY: Use a strong password in production (min 16 chars, mix of letters/numbers/symbols)
# For Docker Compose: Use container name 'postgres' as host
# For local development: Use 'localhost'
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=airline_tracker
POSTGRES_USER=airline_tracker_user
POSTGRES_PASSWORD=change_me_in_production

# ============================================
# INFRASTRUCTURE SERVICES
# ============================================

# Redis Cache (used by flightdata-service for caching flight data)
# For Docker Compose: Use container name 'redis' as host
# For local development: Use 'localhost'
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_CACHE_TTL_SECONDS=300

# Kafka Message Broker (event streaming between services)
# For Docker Compose: Use container name 'kafka' as host
# For local development: Use 'localhost:9092'
KAFKA_BOOTSTRAP_SERVERS=kafka:9092
KAFKA_TOPIC_FLIGHT_DATA=flight-data-events
KAFKA_PORT=9092

# Eureka Service Registry (service discovery)
# For Docker Compose: Use container name 'service-registry' as host
# For local development: Use 'localhost:8761'
EUREKA_DEFAULT_ZONE=http://service-registry:8761/eureka/
EUREKA_SERVER_URL=http://service-registry:8761/eureka/

# ============================================
# MICROSERVICE PORTS
# ============================================

# Service Registry (Eureka)
EUREKA_SERVER_PORT=8761

# API Gateway
API_GATEWAY_PORT=8080

# Flight Data Service
FLIGHTDATA_SERVICE_PORT=8081

# LLM Summary Service
LLM_SUMMARY_SERVICE_PORT=8082

# ============================================
# OPTIONAL CONFIGURATION
# ============================================

# Logging Levels (DEBUG, INFO, WARN, ERROR)
# Recommendation: Use INFO for production, DEBUG for troubleshooting
LOG_LEVEL_ROOT=INFO
LOG_LEVEL_APP=INFO

# API Timeouts and Retry Configuration
FLIGHTAWARE_API_TIMEOUT_SECONDS=5
FLIGHTAWARE_API_RETRY_ATTEMPTS=3

# ============================================
# MONITORING & OBSERVABILITY (PRD NFR-4)
# ============================================

# Prometheus - Metrics Collection
PROMETHEUS_PORT=9090

# Grafana - Metrics Visualization  
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin

# ============================================
# PRODUCTION DEPLOYMENT NOTES
# ============================================
#
# SECURITY CHECKLIST:
# ✅ 1. Change POSTGRES_PASSWORD to a strong password (min 16 chars)
# ✅ 2. Never commit .env to version control (already in .gitignore)
# ✅ 3. Use secrets management for production (AWS Secrets Manager, Vault, etc.)
# ✅ 4. Rotate API keys regularly (every 90 days recommended)
# ✅ 5. Enable HTTPS/TLS in production (use nginx/traefik reverse proxy)
# ✅ 6. Restrict database access (firewall rules, VPC, security groups)
#
# RESOURCE LIMITS (Current docker-compose.yml settings):
# - Each microservice: 512MB-1GB RAM, 0.5-1 CPU core
# - PostgreSQL: 512MB-1GB RAM, 1 CPU core
# - Redis: 256MB-512MB RAM, 0.5 CPU core
# - Kafka: 1GB-2GB RAM, 1 CPU core
# - Total: ~4-8GB RAM, ~6-7 CPU cores
#
# RECOMMENDED CLOUD INSTANCE:
# - AWS: t3.xlarge (4 vCPU, 16GB RAM) - ~$120/month
# - GCP: n2-standard-4 (4 vCPU, 16GB RAM) - ~$120/month
# - Azure: Standard_D4s_v3 (4 vCPU, 16GB RAM) - ~$140/month
# - DigitalOcean: 8GB Droplet (4 vCPU, 8GB RAM) - ~$48/month
#
# DATA PERSISTENCE:
# - PostgreSQL data: /var/lib/postgresql/data (volume: postgres_data)
# - Redis data: /data (volume: redis_data)
# - Kafka data: /var/lib/kafka/data (volume: kafka_data)
# - Backup strategy: docker run --rm -v postgres_data:/data -v $(pwd):/backup ubuntu tar czf /backup/backup.tar.gz /data
#
# MONITORING:
# - Health checks: http://localhost:8080/actuator/health (API Gateway)
# - Eureka dashboard: http://localhost:8761
# - Logs: docker-compose logs -f [service-name]
#
# For local development with localhost instead of container names:
# - Set POSTGRES_HOST=localhost
# - Set REDIS_HOST=localhost
# - Set KAFKA_BOOTSTRAP_SERVERS=localhost:9092
# - Set EUREKA_DEFAULT_ZONE=http://localhost:8761/eureka/

